---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';

// 3. è‡ªåŠ¨éå†å›¾ç‰‡
const images = await Astro.glob('/src/photos/*.{jpg,jpeg,png,webp,avif}');

// 2 & 6. åœ¨ const ä¸­å®šä¹‰å›¾ç‰‡æ³¨é‡Š
// ä½ å¯ä»¥æŒ‰é¡ºåºå†™ä¸‹æ¯å¼ å›¾ç‰‡çš„æ³¨é‡Šï¼Œå¦‚æœå›¾ç‰‡å¤šäºæ³¨é‡Šï¼Œåé¢ä¼šé»˜è®¤ç•™ç©º
const photoCaptions = [
    "Shenzhen, China, Apr 2023",
    "Dali, China,Jul 2023",
    "Lijiang, China, Jul 2023",
    "Nanning, China, Feb 2024",
    "Robloxia, Jun 2024",
    "New York, Robloxia, Jul 2024",
	"Bangkok, Thailand, Aug 2024",
	"Chiang Mai, Thailand, Aug 2024",
	"Robloxia, Nov 2024",
	"Frappe, Robloxia, Oct 2024",
	"Sara, Robloxia, Dec 2024",
	"Greenville, Robloxia, Jan 2025",
	"Shanghai, China, Aug 2025",
	"Changsha, China, May 2025",
	"Nanning, China, Jun 2025",
	"Beihai, China, Oct 2025",
	"Slong City, Cities: Skylines, Dec 2025",
	"Chongqing, China, Feb 2026",
	"Guangxi, China, Feb 2026",
];

const partners = ["Paramecium", "Hydrolight", "Odysphere", "Roblox", "Google", "CloudFlare", "Astro", "Github", "Gemini", "You can be next"];
const pr_web = [
    "https://paramecium2010.top", "https://hydrolight.top", "https://www.roblox.com", "https://www.odysphere.tech/",
    "https://www.google.com", "https://www.cloudflare.com", "https://astro.build",
    "https://github.com", "https://gemini.google.com", "./sponsor"
];

const galleryQuote = "It doesn't matter where you start, it's how you progress from there.";
---

<Layout title="Crepuscular's Villa">
    <Header />
    
    <main class="main-content">
        <div class="scrolling-text" id="scrollText">CREPUSCULAR'S VILLA, ENJOY LIFE STYLES</div>

        <section class="content-section reveal">
            <div class="container safe-zone">
                <h1 class="hero-title">
                    Where Ideas <span id="lineBreak"></span><span id="typewriter" class="accent-text"></span><span class="cursor"></span>
                </h1>
                <p class="sub-text">Relax, and enjoy.</p>
            </div>
        </section>

        <section class="photo-gallery-section safe-zone">
            <div class="gallery-stack">
                
                {images.map((img, index) => {
                    // 1. åŠ¨æ€è®¡ç®—å°ºå¯¸ä¸ä½ç½®
                    const isEven = index % 2 === 0;
                    // å¾ªç¯å®šä¹‰ä¸‰ç§å¤§å°æ¡£ä½
                    const sizes = ['size-s', 'size-m', 'size-l'];
                    const sizeClass = sizes[index % 3];
                    const alignClass = isEven ? 'align-left' : 'align-right';
                    
                    return (
                        <div class={`photo-container ${sizeClass} ${alignClass}`}>
                            {/* 6. å›¾ç‰‡æ—çš„æ³¨é‡Šå°å­— */}
                            {photoCaptions[index] && (
                                <span class="photo-annotation">{photoCaptions[index]}</span>
                            )}
                            <div class="photo-wrapper">
                                <img src={img.default.src} alt={`Gallery item ${index}`} loading="lazy" />
                            </div>
                        </div>
                    );
                })}

                <div class="gallery-quote-box">
                    <p class="quote-text">{galleryQuote}</p>
                    <span class="quote-author">â€” Lando Norris</span>
                </div>
            </div>
        </section>

        <section class="auto-scroll-section">
            <div class="horizontal-view">
                <div class="partner-intro safe-zone">
                    <h2 class="partner-sub-title">PARTNERS & SPONSORS</h2>
                    <p class="partner-desc">Simply Lovely!</p>
                </div>
                
                <div class="infinite-scroll-container">
                    <div class="partner-list">
                        {partners.map((p, i) => (
                            <a href={pr_web[i]} class="logo-card" target="_blank" rel="noopener noreferrer">
                                <span class="logo-name">{p}</span>
                            </a>
                        ))}
                        {partners.map((p, i) => (
                            <a href={pr_web[i]} class="logo-card" target="_blank" rel="noopener noreferrer">
                                <span class="logo-name">{p}</span>
                            </a>
                        ))}
                    </div>
                </div>
            </div>
        </section>

        <section class="contact-section">
            <div class="contact-container safe-zone">
                <h2 class="contact-title">WHAT'S UP ON INTERNET</h2>
                <p class="partner-desc">Follow Me on socials</p>
                <div class="social-links">
                    <a href="https://qm.qq.com/q/Qme3jDzp2G" class="social-card" target="_blank" rel="noopener noreferrer">
                        <span class="social-icon">ğŸ§</span>
                        <span class="social-name">QQ</span>
                    </a>
                    <a href="https://www.youtube.com/@Crepuscular_official" class="social-card" target="_blank" rel="noopener noreferrer">
                        <span class="social-icon">â–¶</span>
                        <span class="social-name">Youtube</span>
                    </a>
                    <a href="https://www.tiktok.com/@crepuscu1ar" class="social-card" target="_blank" rel="noopener noreferrer">
                        <span class="social-icon">ğŸ¶</span>
                        <span class="social-name">Tiktok</span>
                    </a>
                    <a href="https://www.douyin.com/user/MS4wLjABAAAAqaOxzbO4yrIUjNbo3HLSUkM3D4RzArWCi9DnFTtQNPlogqyIL6gnrRnzmPwB3WZ7?from_tab_name=main" class="social-card" target="_blank" rel="noopener noreferrer">
                        <span class="social-icon">ğŸµ</span>
                        <span class="social-name">Douyin</span>
                    </a>
                    <a href="https://www.roblox.com/users/3328635171/profile" class="social-card" target="_blank" rel="noopener noreferrer">
                        <span class="social-icon">âœ¨</span>
                        <span class="social-name">Roblox</span>
                    </a>
                </div>
                <p class="partner-desc" style="margin-top: 80px; margin-bottom: 30px;">Radio check? send me</p>
                <div class="email-container">
                    <a href="mailto:E-Crepuscular@outlook.com" class="email-button">
                        <span class="email-icon">âœ‰</span>
                        <span class="email-text">E-Crepuscular@outlook.com</span>
                    </a>
                </div>
            </div>
        </section>
        
        <footer class="site-footer safe-zone">
            <div class="footer-divider"></div>
            <p>Powered By CloudFlare & Crepuscular, Designed and Developed by Claude, Gemini and Cyril</p>
            <p>Copyright Â© 2026 Crepuscular's Villa. All rights reserved.</p>
        </footer>
    </main>
</Layout>

<style>
    :root {
        --safe-area: clamp(20px, 6vw, 80px);
        --accent-color: #f7c46c;
        --sub-title-size: clamp(34px, 7vw, 85px); 
    }

    .main-content { background-color: #f5f5f7; overflow-x: hidden; }
    @media (prefers-color-scheme: dark) {
        .main-content { background-color: #000000; }
    }

    /* --- æ–°å›¾ç‰‡æ¨¡å—æ ·å¼ --- */
    .photo-gallery-section {
        padding: 15vh 0;
        display: flex;
        justify-content: center;
    }

    .gallery-stack {
        display: flex;
        flex-direction: column;
        width: 100%;
        max-width: 2000px;
        gap: 12vh; /* ä½¿ç”¨è§†å£é«˜åº¦å•ä½æ§åˆ¶é—´è·ï¼Œæ›´å…·åŠ¨æ€æ„Ÿ */
    }

    .photo-container {
        display: flex;
        flex-direction: column;
        position: relative;
        /* 5. å·¦å³æ‘†æ”¾é€»è¾‘ */
        &.align-left { align-self: flex-start; }
        &.align-right { align-self: flex-end; }
    }

    /* 1. åŠ¨æ€å¤§å°æ§åˆ¶ï¼šåŸºäºè§†å£å®½åº¦ (vw) */
    .size-s { width: 35vw; min-width: 250px; max-width: 650px; }
    .size-m { width: 45vw; min-width: 300px; max-width: 750px; }
    .size-l { width: 55vw; min-width: 350px; max-width: 850px; }

    .photo-wrapper {
        width: 100%;
        overflow: hidden;
        box-shadow: 0 20px 40px rgba(0,0,0,0.08);
    }

    .photo-wrapper img {
        width: 100%;
        height: auto;
        display: block;
        /* 5. ä¸ç”¨åœ†è§’ */
        border-radius: 0;
        transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    }

    .photo-container:hover img {
        transform: scale(1.05);
    }

    /* 2 & 6. æ³¨é‡Šå°å­—æ ·å¼ */
    .photo-annotation {
        font-size: 10px;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: #86868b;
        margin-bottom: 8px;
        font-weight: 500;
    }

    .gallery-quote-box {
        margin: 12vh auto;
        text-align: center;
        max-width: 1600px;
		font-family: 'RAGE', cursive;
		font-size: 1.75rem;
    }

    .quote-text {
        font-family: serif;
        font-size: clamp(20px, 3vw, 32px);
        font-style: italic;
        line-height: 1.3;
        margin-bottom: 15px;
        color: #1d1d1f;
    }

    /* --- åŸæœ‰æ ·å¼å…¼å®¹ --- */
    .logo-name { font-family: 'RAGE', cursive; font-size: 48px; font-weight: 600; color: #1d1d1f; }
    .scrolling-text { position: fixed; top: 25%; left: 0; font-size: 15vw; font-weight: 900; color: rgba(247, 196, 108, 0.05); white-space: nowrap; pointer-events: none; z-index: 0; }
    .safe-zone { padding-left: var(--safe-area); padding-right: var(--safe-area); }
    .content-section { min-height: 100vh; display: flex; align-items: center; position: relative; z-index: 1; }
    .hero-title { font-size: clamp(44px, 12vw, 130px); font-weight: 800; line-height: 1.1; }
    .accent-text { color: var(--accent-color); }
    .auto-scroll-section { padding: 100px 0; background: #f5f5f7; overflow: hidden; }
    @media (prefers-color-scheme: dark) {
        .auto-scroll-section { background: #000000; }
    }
    .horizontal-view { display: flex; flex-direction: column; gap: 60px; }
    .partner-sub-title { font-size: var(--sub-title-size); font-weight: 800; line-height: 1; margin: 0; }
    .partner-desc { font-size: clamp(16px, 2vw, 24px); color: #86868b; margin: 0 0 60px 0; font-weight: var(--fw-light); line-height: 1.6; }
    .infinite-scroll-container { width: 100%; overflow: hidden; display: flex; -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
    .partner-list { display: flex; gap: 40px; padding: 20px 0; animation: scroll-left 30s linear infinite; width: max-content; }
    .logo-card { width: 320px; height: 200px; background: #fff; border-radius: 30px; display: flex; justify-content: center; align-items: center; box-shadow: 0 4px 20px rgba(0,0,0,0.02); flex-shrink: 0; transition: all 0.3s ease; text-decoration: none; }
    .logo-card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.08); }
    .contact-section { padding: 100px 0; background: #f5f5f7; }
    @media (prefers-color-scheme: dark) {
        .contact-section { background: #000000; }
    }
    .contact-container { display: flex; flex-direction: column; align-items: center; text-align: center; max-width: 1000px; margin: 0 auto; }
    .contact-title { font-size: var(--sub-title-size); font-weight: 800; line-height: 1.2; margin: 0 0 20px 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    @media (max-width: 1024px) {
        .contact-title { white-space: normal; overflow: visible; }
    }
    .email-container { width: 100%; display: flex; justify-content: center; }
    .email-button { display: flex; align-items: center; justify-content: center; gap: 12px; width: calc(100% - (var(--safe-area) * 2)); height: clamp(48px, 10vw, 80px); background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.02); text-decoration: none; transition: all 0.3s ease; color: #1d1d1f; }
    .email-button:hover { transform: translateY(-4px); box-shadow: 0 12px 28px rgba(0,0,0,0.08); }
    .email-button:hover .email-icon { color: var(--accent-color); }
    .email-button:hover .email-text { color: var(--accent-color); }
    .email-icon { font-size: 24px; font-family: 'Segoe UI Emoji', 'Apple Color Emoji', sans-serif; color: #1d1d1f; transition: color 0.3s ease; flex-shrink: 0; }
    .email-text { font-size: 16px; font-weight: 600; color: #1d1d1f; transition: color 0.3s ease; }
    @media (min-width: 768px) {
        .email-icon { font-size: clamp(24px, 2vw, 32px); }
        .email-text { font-size: clamp(16px, 1.5vw, 20px); }
    }
    @media (prefers-color-scheme: dark) {
        .email-button { background: #1d1d1f; color: #f5f5f7; }
        .email-icon { color: #f5f5f7; }
        .email-text { color: #f5f5f7; }
    }
    .social-links { display: grid; grid-template-columns: repeat(5, 1fr); gap: clamp(12px, 3vw, 24px); width: 100%; max-width: 1000px; margin: 0 auto; }
    .social-card { width: 100%; aspect-ratio: 1; background: #fff; border-radius: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 4px 20px rgba(0,0,0,0.02); transition: all 0.3s ease; text-decoration: none; border: none; cursor: pointer; }
    .social-card:hover { transform: translateY(-8px); box-shadow: 0 15px 30px rgba(0,0,0,0.08); }
    .social-card:hover .social-icon { color: var(--accent-color); }
    .social-card:hover .social-name { color: var(--accent-color); }
    .social-icon { font-size: 32px; font-weight: 700; color: #1d1d1f; margin-bottom: 10px; font-family: 'Segoe UI Emoji', 'Apple Color Emoji', sans-serif; transition: color 0.3s ease; }
    .social-name { font-size: 14px; font-weight: 600; color: #86868b; transition: color 0.3s ease; }
    @media (prefers-color-scheme: dark) {
        .social-card { background: #1d1d1f; }
        .social-name { color: #a1a1a6; }
        .social-icon { color: #f5f5f7; }
    }
    .site-footer { padding: 80px 0 40px; text-align: center; color: #86868b; font-size: 13px; }
    .footer-divider { width: 100%; height: 1px; background: rgba(0,0,0,0.1); margin-bottom: 24px; }
    .cursor { display: inline-block; width: 3px; height: 0.8em; background: var(--accent-color); margin-left: 4px; vertical-align: middle; animation: blink 1s step-end infinite; }
    @keyframes blink { 50% { background: transparent; } }
    @keyframes scroll-left { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
    .reveal { opacity: 0; transform: translateY(30px); transition: all 1s ease-out; }
    .reveal.active { opacity: 1; transform: translateY(0); }
    @media (max-width: 768px) {
        .social-links { grid-template-columns: repeat(4, 1fr); }
    }
    @media (max-width: 600px) {
        .social-links { grid-template-columns: repeat(3, 1fr); }
    }
    @media (max-width: 450px) {
        .social-links { grid-template-columns: repeat(2, 1fr); }
    }
</style>

<script>
    // æ‰“å­—æœºä¸æ»šåŠ¨é€»è¾‘ä¿æŒä¸å˜
    const words = ["Define.", "Spark.", "Breathe.", "Manifest.", "Endure."];
    let wordIndex = 0, charIndex = 0, isDeleting = false;
    
    function type() {
        const target = document.getElementById('typewriter');
        if (!target) return;
        const currentWord = words[wordIndex];
        if (isDeleting) charIndex--; else charIndex++;
        target.textContent = currentWord.substring(0, charIndex);
        let delta = isDeleting ? 80 : 150;
        if (!isDeleting && charIndex === currentWord.length) { delta = 2000; isDeleting = true; }
        else if (isDeleting && charIndex === 0) { isDeleting = false; wordIndex = (wordIndex + 1) % words.length; delta = 500; }
        setTimeout(type, delta);
    }

    function handleScroll() {
        const scrolled = window.scrollY;
        const scrollText = document.getElementById('scrollText');
        if (scrollText) scrollText.style.transform = `translateX(-${scrolled * 0.4}px)`;
    }

    document.addEventListener('DOMContentLoaded', () => {
        type();
        window.addEventListener('scroll', handleScroll);
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); });
        }, { threshold: 0.1 });
        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
    });
</script>